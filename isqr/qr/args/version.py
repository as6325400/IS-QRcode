# Modified at: 2023.8.15
# Author: Steven

"""
根據QR code的規範，處理QR code的版本
所對應的資訊。
"""

# 每個版本對應的可能中心點座標
VERSION_CENTER = {2: {6, 18}, 3: {6, 22}, 4: {6, 26}, 5: {6, 30}, 6: {6, 34}, 7: {6, 22, 38}, 8: {6, 24, 42}, 9: {6, 26, 46}, 10: {6, 28, 50},
                  11: {6, 30, 54}, 12: {6, 32, 58}, 13: {6, 34, 62}, 14: {6, 26, 46, 66}, 15: {6, 26, 48, 70}, 16: {6, 26, 50, 74}, 17: {6, 30, 54, 78},
                  18: {6, 30, 56, 82}, 19: {6, 30, 58, 86}, 20: {6, 34, 62, 90}, 21: {6, 28, 50, 72, 94}, 22: {6, 26, 50, 74, 98}, 23: {6, 30, 54, 78, 102},
                  24: {6, 28, 54, 80, 106}, 25: {6, 32, 58, 84, 110}, 26: {6, 30, 58, 86, 114}, 27: {6, 34, 62, 90, 118}, 28: {6, 26, 50, 74, 98, 122},
                  29: {6, 30, 54, 78, 102, 126}, 30: {6, 26, 52, 78, 104, 130}, 31: {6, 30, 56, 82, 108, 134}, 32: {6, 34, 60, 86, 112, 138}, 33: {6, 30, 58, 86, 114, 142},
                  34: {6, 34, 62, 90, 118, 146}, 35: {6, 30, 54, 78, 102, 126, 150}, 36: {6, 24, 50, 76, 102, 128, 154}, 37: {6, 28, 54, 80, 106, 132, 158},
                  38: {6, 32, 58, 84, 110, 136, 162}, 39: {6, 26, 54, 82, 110, 138, 166}, 40: {6, 30, 58, 86, 114, 142, 170}}

# 每個版本對應的版本資訊 (18 bits)
VERSION_INFO = {7: "000111110010010100", 8: "001000010110111100", 9: "001001101010011001", 10: "001010010011010011", 11: "001011101111110110",
                12: "001100011101100010", 13: "001101100001000111", 14: "001110011000001101", 15: "001111100100101000", 16: "010000101101111000",
                17: "010001010001011101", 18: "010010101000010111", 19: "010011010100110010", 20: "010100100110100110", 21: "010101011010000011",
                22: "010110100011001001", 23: "010111011111101100", 24: "011000111011000100", 25: "011001000111100001", 26: "011010111110101011",
                27: "011011000010001110", 28: "011100110000011010", 29: "011101001100111111", 30: "011110110101110101", 31: "011111001001010000",
                32: "100000100111010101", 33: "100001011011110000", 34: "100010100010111010", 35: "100011011110011111", 36: "100100101100001011",
                37: "100101010000101110", 38: "100110101001100100", 39: "100111010101000001", 40: "101000110001101001"}

# 每個版本對應的remainder bit數量
VERSION_REMAINDER_BIT = {1: 0, 2: 7, 3: 7, 4: 7, 5: 7, 6: 7, 7: 0, 8: 0, 9: 0, 10: 0, 11: 0, 12: 0, 13: 0, 14: 3, 15: 3, 16: 3, 17: 3, 18: 3, 19: 3, 20: 3,
                         21: 4, 22: 4, 23: 4, 24: 4, 25: 4, 26: 4, 27: 4, 28: 3, 29: 3, 30: 3, 31: 3, 32: 3, 33: 3, 34: 3, 35: 0, 36: 0, 37: 0, 38: 0, 39: 0,
                         40: 0}

# =======================
# Define class and method
# =======================
class QrVersion():
    """
    使用的都是decorator，把method轉換為此class的attribute。
    """
    def __init__(self, version_number):
        assert 1 <= version_number <= 40, "Wrong version number! must between 1 and 40."
        self._version_num = version_number

    @property
    def number(self):
        return self._version_num

    @property
    def size(self):
        return 17 + 4 * self.number

    @property
    def possible_center(self):
        return VERSION_CENTER[self.number]

    @property
    def version_info(self):
        return VERSION_INFO[self.number]

    @property
    def remainder_bit(self):
        return VERSION_REMAINDER_BIT[self.number]
